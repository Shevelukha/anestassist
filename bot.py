from __future__ import annotations
AI_SIGNATURE = "ü§ñ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —à—Ç—É—á–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (AI)."
POWERED_BY = "‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: LLM (–º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ò–ò) + –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞. –û—Å–≤—ñ—Ç–Ω—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç."

# –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (WELCOME_TEXT), —á—Ç–æ–±—ã —É–ø–æ–º—è–Ω—É—Ç—å AI
WELCOME_TEXT = (
    "üëã –í—ñ—Ç–∞—é! –Ø –±–æ—Ç –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏ —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.\n"
    "–ü—Ä–∞—Ü—é—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É (AI) —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.\n"
    "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å /help, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–∏. –î–ª—è –æ—Ü—ñ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å—É ‚Äî /algo."
)

# –æ–±–Ω–æ–≤–∏—Ç–µ ABOUT_TEXT —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º AI
ABOUT_TEXT = (
    "ü©∫ Hemodynamics/Volume Support Bot ‚Äî MVP\n\n"
    "–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –Ω–∞–≤—á–∞–ª—å–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é –∫—Ä–æ–≤–æ–æ–±—ñ–≥—É —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ "
    "–Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.\n\n"
    f"{POWERED_BY}\n\n"
    "–î–∂–µ—Ä–µ–ª–∞ –ª–æ–≥—ñ–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –∑ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ –≥–∞–π–¥–ª–∞–π–Ω–∞–º–∏ "
    "(ESICM/ILTS/KDIGO —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏).\n"
    "‚ö†Ô∏è –¶–µ –Ω–µ –º–µ–¥–∏—á–Ω–∞ –ø–æ—Ä–∞–¥–∞; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ª–∏—à–µ –∑ –æ—Å–≤—ñ—Ç–Ω—å–æ—é –º–µ—Ç–æ—é."
)
AI_SIGNATURE = "ü§ñ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —à—Ç—É—á–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (AI)."
POWERED_BY = "‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: LLM (–º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ò–ò) + –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞. –û—Å–≤—ñ—Ç–Ω—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç."

# –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (WELCOME_TEXT), —á—Ç–æ–±—ã —É–ø–æ–º—è–Ω—É—Ç—å AI
WELCOME_TEXT = (
    "üëã –í—ñ—Ç–∞—é! –Ø –±–æ—Ç –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏ —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.\n"
    "–ü—Ä–∞—Ü—é—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É (AI) —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.\n"
    "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å /help, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–∏. –î–ª—è –æ—Ü—ñ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å—É ‚Äî /algo."
)

# –æ–±–Ω–æ–≤–∏—Ç–µ ABOUT_TEXT —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º AI
ABOUT_TEXT = (
    "ü©∫ Hemodynamics/Volume Support Bot ‚Äî MVP\n\n"
    "–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –Ω–∞–≤—á–∞–ª—å–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é –∫—Ä–æ–≤–æ–æ–±—ñ–≥—É —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ "
    "–Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.\n\n"
    f"{POWERED_BY}\n\n"
    "–î–∂–µ—Ä–µ–ª–∞ –ª–æ–≥—ñ–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –∑ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ –≥–∞–π–¥–ª–∞–π–Ω–∞–º–∏ "
    "(ESICM/ILTS/KDIGO —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏).\n"
    "‚ö†Ô∏è –¶–µ –Ω–µ –º–µ–¥–∏—á–Ω–∞ –ø–æ—Ä–∞–¥–∞; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ª–∏—à–µ –∑ –æ—Å–≤—ñ—Ç–Ω—å–æ—é –º–µ—Ç–æ—é."
)
AI_SIGNATURE = "ü§ñ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —à—Ç—É—á–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (AI)."
POWERED_BY = "‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: LLM (–º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ò–ò) + –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞. –û—Å–≤—ñ—Ç–Ω—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç."

# –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (WELCOME_TEXT), —á—Ç–æ–±—ã —É–ø–æ–º—è–Ω—É—Ç—å AI
WELCOME_TEXT = (
    "üëã –í—ñ—Ç–∞—é! –Ø –±–æ—Ç –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏ —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.\n"
    "–ü—Ä–∞—Ü—é—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É (AI) —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.\n"
    "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å /help, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–∏. –î–ª—è –æ—Ü—ñ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å—É ‚Äî /algo."
)

# –æ–±–Ω–æ–≤–∏—Ç–µ ABOUT_TEXT —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º AI
ABOUT_TEXT = (
    "ü©∫ Hemodynamics/Volume Support Bot ‚Äî MVP\n\n"
    "–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –Ω–∞–≤—á–∞–ª—å–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é –∫—Ä–æ–≤–æ–æ–±—ñ–≥—É —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ "
    "–Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.\n\n"
    f"{POWERED_BY}\n\n"
    "–î–∂–µ—Ä–µ–ª–∞ –ª–æ–≥—ñ–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –∑ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ –≥–∞–π–¥–ª–∞–π–Ω–∞–º–∏ "
    "(ESICM/ILTS/KDIGO —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏).\n"
    "‚ö†Ô∏è –¶–µ –Ω–µ –º–µ–¥–∏—á–Ω–∞ –ø–æ—Ä–∞–¥–∞; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ª–∏—à–µ –∑ –æ—Å–≤—ñ—Ç–Ω—å–æ—é –º–µ—Ç–æ—é."
)
"""
Hemodynamics/Volume Support Telegram Bot ‚Äî MVP template (python-telegram-bot v20)
–ê–≤—Ç–æ—Ä: –≤–∞—à AI-–ø–æ–º—ñ—á–Ω–∏–∫
–õ—ñ—Ü–µ–Ω–∑—ñ—è: –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π; –Ω–µ —î –º–µ–¥–∏—á–Ω–æ—é –ø–æ—Ä–∞–¥–æ—é.

–Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
1) Python 3.10+
2) pip install -r requirements.txt (–¥–∏–≤. –∫—ñ–Ω–µ—Ü—å —Ñ–∞–π–ª—É)
3) –£—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ TELEGRAM_TOKEN = <–≤–∞—à_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather>
4) –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ:  python bot.py
5) –î–ª—è 24/7 —Ö–æ—Å—Ç–∏–Ω–≥—É: Railway/Render/VPS (–¥–∏–≤. —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —É README-–±–ª–æ—Ü—ñ –≤–Ω–∏–∑—É).

–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª MVP:
- /start, /help, /about
await update.message.reply_html(
    "üìä <b>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>\n‚Ä¢ ...\n\nüí° <b>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:</b>\n‚Ä¢ ...\n\n‚ö†Ô∏è ...")

await update.message.reply_html(
    "üìä <b>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>\n‚Ä¢ ...\n\nüí° <b>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:</b>\n‚Ä¢ ...\n\n‚ö†Ô∏è ...")

await update.message.reply_html(
    "üìä <b>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>\n‚Ä¢ ...\n\nüí° <b>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:</b>\n‚Ä¢ ...\n\n‚ö†Ô∏è ...")

	await update.message.reply_html(
    "üìä <b>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>\n‚Ä¢ ...\n\nüí° <b>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:</b>\n‚Ä¢ ...\n\n‚ö†Ô∏è ...")


x- /algo ‚Äî –ø—Ä–æ—Å—Ç–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –≤–≤–æ–¥—É CI, GEDI, EVLWI, PPV, MAP, Lactate
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–≤–µ–¥–µ–Ω–Ω—è, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏, –æ—Å–≤—ñ—Ç–Ω—ñ –∫—Ä–æ–∫–∏ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏
- /feedback ‚Äî –∑–±–∏—Ä–∞–Ω–Ω—è –≤—ñ–¥–≥—É–∫—É (–≤ –∫–æ–Ω—Å–æ–ª—å –∞–±–æ –ª–æ–≥)
- –î–∏—Å–∫–ª–µ–π–º–µ—Ä —É –∫–æ–∂–Ω—ñ–π –∫–ª—ñ–Ω—ñ—á–Ω—ñ–π –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

–ü—Ä–∏–º—ñ—Ç–∫–∞: –£—Å—ñ –ø–æ—Ä–æ–≥–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–∞ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó –¥–æ –≤–∞—à–∏—Ö –ª–æ–∫–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤.
"""

import logging
import os
import re
from textwrap import dedent
from typing import Dict, Optional

from telegram import Update, ReplyKeyboardMarkup, KeyboardButton
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    MessageHandler,
    ConversationHandler,
    ContextTypes,
    filters,
)

# -------------------- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ --------------------
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    level=logging.INFO,
)
logger = logging.getLogger(__name__)

# -------------------- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ --------------------
TOKEN = os.getenv("TELEGRAM_TOKEN")  # –¥–æ–¥–∞–π—Ç–µ —É —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

# –°—Ç–∞–Ω–∏ –¥–ª—è ConversationHandler
ASK_INPUT = 1

DISCLAIMER = (
    "‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: –í—ñ–¥–ø–æ–≤—ñ–¥—ñ –±–æ—Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –õ–ò–®–ï –¥–ª—è –æ—Å–≤—ñ—Ç–Ω—ñ—Ö —Ü—ñ–ª–µ–π —ñ –Ω–µ —î –º–µ–¥–∏—á–Ω–æ—é –ø–æ—Ä–∞–¥–æ—é.\n"
    "–ö–ª—ñ–Ω—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞—î –ª—ñ–∫–∞—Ä –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —Å–∏—Ç—É–∞—Ü—ñ—ó, –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤.")

HELP_TEXT = dedent(
    """
    üìå –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:
    /start ‚Äî –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è
    /help ‚Äî –¥–æ–≤—ñ–¥–∫–∞
    /about ‚Äî –ø—Ä–æ –±–æ—Ç–∞
    /algo ‚Äî –æ—Ü—ñ–Ω–∫–∞ –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É (–≤–≤—ñ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤)
    /feedback ‚Äî –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é/–ø–æ–º–∏–ª–∫—É

    –§–æ—Ä–º–∞—Ç–∏ –≤–≤–æ–¥—É –¥–ª—è /algo:
    ‚Ä¢ –£ —Ä—è–¥–æ–∫ —á–µ—Ä–µ–∑ –∫–æ–º—É: CI=2.1, GEDI=620, EVLWI=7, PPV=15, MAP=58, Lactate=3.2
    ‚Ä¢ –ê–±–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞ –≤ –ø–æ—Ä—è–¥–∫—É: 2.1, 620, 7, 15, 58, 3.2

    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ (–æ–¥–∏–Ω–∏—Ü—ñ –ø—Ä–∏–∫–ª–∞–¥–Ω—ñ):
    - CI (–ª/—Ö–≤/–º¬≤)
    - GEDI (–º–ª/–º¬≤)
    - EVLWI (–º–ª/–∫–≥)
    - PPV (%)
    - MAP (–º–º —Ä—Ç. —Å—Ç.)
    - Lactate (–º–º–æ–ª—å/–ª)
    """
)

ABOUT_TEXT = dedent(
    """
    ü©∫ Hemodynamics/Volume Support Bot ‚Äî MVP

    –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –Ω–∞–≤—á–∞–ª—å–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é –∫—Ä–æ–≤–æ–æ–±—ñ–≥—É —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.\n
    –î–∂–µ—Ä–µ–ª–∞ –ª–æ–≥—ñ–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –∑ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ –≥–∞–π–¥–ª–∞–π–Ω–∞–º–∏ (ESICM/ILTS/KDIGO —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏).\n
    –ê–≤—Ç–æ—Ä: –∞–Ω–µ—Å—Ç–µ–∑—ñ–æ–ª–æ–≥ + AI. –¶–µ–π –±–æ—Ç ‚Äî –ø—Ä–æ—Ç–æ—Ç–∏–ø –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó. 
    """
)

WELCOME_TEXT = dedent(
    """
    üëã –í—ñ—Ç–∞—é! –Ø –±–æ—Ç –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –≥–µ–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏ —Ç–∞ –≤–æ–ª–µ–º—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.
    –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å /help, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–∏. –î–ª—è –æ—Ü—ñ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å—É ‚Äî /algo.
    """
)

# -------------------- –•–µ–ª–ø–µ—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É --------------------
PARAM_KEYS = ["CI", "GEDI", "EVLWI", "PPV", "MAP", "Lactate"]

num_re = re.compile(r"-?\d+(?:[\.,]\d+)?")


def _to_float(x: str) -> Optional[float]:
    try:
        return float(x.replace(",", "."))
    except Exception:
        return None


def parse_params(text: str) -> Dict[str, Optional[float]]:
    """–ü–∞—Ä—Å–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ 'CI=2.1, GEDI=620, EVLWI=7, PPV=15, MAP=58, Lactate=3.2'
    –∞–±–æ '2.1, 620, 7, 15, 58, 3.2'. –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ª–æ–≤–Ω–∏–∫ –∑ —á–∏—Å–ª–∞–º–∏ –∞–±–æ None."""
    values: Dict[str, Optional[float]] = {k: None for k in PARAM_KEYS}

    # –°–ø—Ä–æ–±–∞ —Ñ–æ—Ä–º–∞—Ç—É key=value
    if any("=" in part for part in text.split(""",""")) or any("=" in part for part in text.split()):
        # —Ä–æ–∑–±–∏—Ç–∏ –∑–∞ –∫–æ–º–∞–º–∏/–ø—Ä–æ–±—ñ–ª–∞–º–∏
        parts = re.split(r"[\s,\n]+", text)
        for p in parts:
            if "=" in p:
                key, val = p.split("=", 1)
                key = key.strip().upper()
                val = val.strip()
                if key in (k.upper() for k in PARAM_KEYS):
                    f = _to_float(val)
                    # –º–∞–ø–∏–º–æ –Ω–∞–∑–∞–¥ –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–µ–π—Å—É –∫–ª—é—á–∞
                    for k in PARAM_KEYS:
                        if k.upper() == key:
                            values[k] = f
    else:
        # —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
        nums = [m.group(0) for m in num_re.finditer(text)]
        for i, k in enumerate(PARAM_KEYS):
            if i < len(nums):
                values[k] = _to_float(nums[i])

    return values


# -------------------- –ö–ª—ñ–Ω—ñ—á–Ω–∞ –ª–æ–≥—ñ–∫–∞ (–¥–µ–º–æ) --------------------

def interpret_hemodynamics(p: Dict[str, Optional[float]]) -> str:
    """–î–µ–º–æ-—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è. –ü–æ—Ä–æ–≥–∏ ‚Äî –ø—Ä–∏–∫–ª–∞–¥–Ω—ñ; –∞–¥–∞–ø—Ç—É–π—Ç–µ –ø—ñ–¥ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏.
    –ü–æ–≤–µ—Ä—Ç–∞—î –≥–æ—Ç–æ–≤–∏–π —Ç–µ–∫—Å—Ç –∑ –≤–∏—Å–Ω–æ–≤–∫–∞–º–∏ —Ç–∞ –æ—Å–≤—ñ—Ç–Ω—ñ–º–∏ –∫—Ä–æ–∫–∞–º–∏.
    """
    CI = p.get("CI")
    GEDI = p.get("GEDI")
    EVLWI = p.get("EVLWI")
    PPV = p.get("PPV")
    MAP = p.get("MAP")
    Lact = p.get("Lactate")

    findings = []
    plan = []

    # –ü–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    if GEDI is not None:
        if GEDI < 680:
            findings.append("‚¨áÔ∏è –ü–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–Ω–∏–∂–µ–Ω–µ (GEDI < 680)")
        elif GEDI > 850:
            findings.append("‚¨ÜÔ∏è –ü—ñ–¥–≤–∏—â–µ–Ω–µ –ø–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (GEDI > 850)")
        else:
            findings.append("‚úÖ –ü–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —É –º–µ–∂–∞—Ö —Ü—ñ–ª—å–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å")

    # –†–µ—Å–ø—ñ—Ä–∞—Ç–æ—Ä–Ω—ñ –≤–∞—Ä—ñ–∞—Ü—ñ—ó —è–∫ –º–∞—Ä–∫–µ—Ä fluid responsiveness
    if PPV is not None:
        if PPV > 13:
            findings.append("üíß –í–∏—Å–æ–∫–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —ñ–Ω—Ñ—É–∑—ñ—é (PPV > 13%)")
        elif PPV < 9:
            findings.append("üíß –ù–∏–∑—å–∫–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —ñ–Ω—Ñ—É–∑—ñ—é (PPV < 9%)")
        else:
            findings.append("üíß –°—ñ—Ä–∞ –∑–æ–Ω–∞ PPV (9‚Äì13%), —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ –æ–±–µ—Ä–µ–∂–Ω–æ")

    # –ù–∞—Å–æ—Å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
    if CI is not None:
        if CI < 2.2:
            findings.append("ü´Ä –ù–∏–∑—å–∫–∏–π —Å–µ—Ä—Ü–µ–≤–∏–π —ñ–Ω–¥–µ–∫—Å (CI < 2.2 –ª/—Ö–≤/–º¬≤)")
        elif CI > 4.0:
            findings.append("ü´Ä –í–∏—Å–æ–∫–∏–π —Å–µ—Ä—Ü–µ–≤–∏–π —ñ–Ω–¥–µ–∫—Å (–≥—ñ–ø–µ—Ä–¥–∏–Ω–∞–º—ñ—è)")
        else:
            findings.append("ü´Ä –°–µ—Ä—Ü–µ–≤–∏–π —ñ–Ω–¥–µ–∫—Å —É –º–µ–∂–∞—Ö —Ü—ñ–ª—å–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å")

    # –ü—ñ—Å–ª—è–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–ø–µ—Ä—Ñ—É–∑—ñ—è
    if MAP is not None:
        if MAP < 65:
            findings.append("‚ö° –ì—ñ–ø–æ—Ç–µ–Ω–∑—ñ—è (MAP < 65 –º–º —Ä—Ç. —Å—Ç.)")
        else:
            findings.append("üîß MAP ‚â• 65 –º–º —Ä—Ç. —Å—Ç. ‚Äî —Ü—ñ–ª—å –¥–æ—Å—è–≥–Ω—É—Ç–∞ –∞–±–æ –±–ª–∏–∑—å–∫–æ")

    # –õ–µ–≥–µ–Ω–µ–≤–∏–π —Å—Ç–∞—Ç—É—Å
    if EVLWI is not None:
        if EVLWI > 10:
            findings.append("üåä –ü—ñ–¥–≤–∏—â–µ–Ω–∞ –µ–∫—Å—Ç—Ä–∞–≤–∞—Å–∫—É–ª—è—Ä–Ω–∞ –≤–æ–¥–∞ –ª–µ–≥–µ–Ω—å (EVLWI > 10) ‚Äî —Ä–∏–∑–∏–∫ –Ω–∞–±—Ä—è–∫—É")
        else:
            findings.append("üåä EVLWI —É –ø—Ä–∏–π–Ω—è—Ç–Ω–∏—Ö –º–µ–∂–∞—Ö")

    # –¢–∫–∞–Ω–∏–Ω–Ω–∞ –ø–µ—Ä—Ñ—É–∑—ñ—è (–ª–∞–∫—Ç–∞—Ç)
    if Lact is not None:
        if Lact >= 2.0:
            findings.append("üß™ –ü—ñ–¥–≤–∏—â–µ–Ω–∏–π –ª–∞–∫—Ç–∞—Ç ‚Äî –æ–∑–Ω–∞–∫–∞ –≥—ñ–ø–æ–ø–µ—Ä—Ñ—É–∑—ñ—ó/—Å—Ç—Ä–µ—Å—É")
        else:
            findings.append("üß™ –õ–∞–∫—Ç–∞—Ç –Ω–µ –ø—ñ–¥–≤–∏—â–µ–Ω–∏–π")

    # --- –û—Å–≤—ñ—Ç–Ω—ñ –∫—Ä–æ–∫–∏ (–¥–µ–º–æ-–∞–ª–≥–æ—Ä–∏—Ç–º) ---
    # 1) –Ø–∫—â–æ –Ω–∏–∑—å–∫–µ –ø–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ –≤–∏—Å–æ–∫–∞ fluid responsiveness ‚Üí –±–æ–ª—é—Å –∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ—é –æ—Ü—ñ–Ω–∫–æ—é
    if GEDI is not None and PPV is not None and GEDI < 680 and PPV > 13:
        plan.append("‚û°Ô∏è –û—Å–≤—ñ—Ç–Ω—å–æ: –±–æ–ª—é—Å 250‚Äì500 –º–ª –∫—Ä–∏—Å—Ç–∞–ª–æ—ó–¥—ñ–≤ —ñ–∑ –ø–µ—Ä–µ–æ—Ü—ñ–Ω–∫–æ—é GEDI/CI/PPV —á–µ—Ä–µ–∑ 10‚Äì15 —Ö–≤")

    # 2) –Ø–∫—â–æ EVLWI –≤–∏—Å–æ–∫–∏–π ‚Üí –æ–±–µ—Ä–µ–∂–Ω—ñ—Å—Ç—å –∑ —ñ–Ω—Ñ—É–∑—ñ—î—é
    if EVLWI is not None and EVLWI > 10:
        plan.append("‚û°Ô∏è EVLWI –ø—ñ–¥–≤–∏—â–µ–Ω–∏–π: —É–Ω–∏–∫–∞—Ç–∏ –∞–≥—Ä–µ—Å–∏–≤–Ω–æ—ó —ñ–Ω—Ñ—É–∑—ñ—ó; —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥—ñ—É—Ä–µ—Ç–∏–∫–∏/—É–ª—å—Ç—Ä–∞—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –∑–∞ –ø–æ–∫–∞–∑–∞–Ω–Ω—è–º–∏")

    # 3) –Ø–∫—â–æ MAP < 65 –ø—ñ—Å–ª—è –∫–æ—Ä–µ–∫—Ü—ñ—ó –æ–±'—î–º—É ‚Üí –≤–∞–∑–æ–ø—Ä–µ—Å–æ—Ä
    if MAP is not None and MAP < 65:
        plan.append("‚û°Ô∏è –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ MAP ‚â• 65 –º–º —Ä—Ç. —Å—Ç.: –Ω–æ—Ä–∞–¥—Ä–µ–Ω–∞–ª—ñ–Ω —Ç–∏—Ç—Ä–æ–≤–∞–Ω–æ –ø—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –æ–±'—î–º—É")

    # 4) –Ø–∫—â–æ CI –Ω–∏–∑—å–∫–∏–π –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É/–≤–∏—Å–æ–∫–æ–º—É –ø–µ—Ä–µ–¥–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ ‚Üí —ñ–Ω–æ—Ç—Ä–æ–ø
    if CI is not None and CI < 2.2 and GEDI is not None and GEDI >= 680:
        plan.append("‚û°Ô∏è –†–æ–∑–≥–ª—è–Ω—É—Ç–∏ —ñ–Ω–æ—Ç—Ä–æ–ø–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É (–¥–æ–±—É—Ç–∞–º—ñ–Ω/—ñ–Ω—à—ñ) –∑–∞ –ø–æ–∫–∞–∑–∞–Ω–Ω—è–º–∏")

    # 5) –ü—ñ–¥–≤–∏—â–µ–Ω–∏–π –ª–∞–∫—Ç–∞—Ç ‚Üí –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫—É/—Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è O2, –∫—Ä–æ–≤–æ—Ç—ñ–∫, –¥–∂–µ—Ä–µ–ª–æ —Å–µ–ø—Å–∏—Å—É —Ç–æ—â–æ
    if Lact is not None and Lact >= 2.0:
        plan.append("‚û°Ô∏è –û—Ü—ñ–Ω–∏—Ç–∏ DO2/VO2, –≥–µ–º–æ–≥–ª–æ–±—ñ–Ω, –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ—é/–æ–∫—Å–∏–≥–µ–Ω–∞—Ü—ñ—é, –¥–∂–µ—Ä–µ–ª–æ —ñ–Ω—Ñ–µ–∫—Ü—ñ—ó, –º–µ—Ç–∞–±–æ–ª—ñ—á–Ω—ñ —á–∏–Ω–Ω–∏–∫–∏")

    # –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
    lines = ["üìä **–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è:**"] + [f"‚Ä¢ {x}" for x in findings]
    if plan:
        lines += ["\nüí° **–û—Å–≤—ñ—Ç–Ω—ñ –∫—Ä–æ–∫–∏:**"] + [f"‚Ä¢ {x}" for x in plan]
    lines += ["\n" + DISCLAIMER]

    return "\n".join(lines)


# -------------------- –•–µ–Ω–¥–ª–µ—Ä–∏ --------------------
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    kb = ReplyKeyboardMarkup(
        [[KeyboardButton("/algo"), KeyboardButton("/help")]], resize_keyboard=True
    )
    await update.message.reply_text(WELCOME_TEXT, reply_markup=kb)


async def help_cmd(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(HELP_TEXT)


async def about(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(ABOUT_TEXT)


# --- /algo —Ä–æ–∑–º–æ–≤–∞ ---
async def algo_entry(update: Update, context: ContextTypes.DEFAULT_TYPE):
    prompt = dedent(
        """
        –í–≤–µ–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —É –±—É–¥—å-—è–∫–æ–º—É –∑ —Ñ–æ—Ä–º–∞—Ç—ñ–≤:
        ‚Ä¢ CI=2.1, GEDI=620, EVLWI=7, PPV=15, MAP=58, Lactate=3.2
        ‚Ä¢ –∞–±–æ: 2.1, 620, 7, 15, 58, 3.2
        """
    )
    await update.message.reply_text(prompt)
    return ASK_INPUT


async def algo_handle(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text or ""
    params = parse_params(text)

    missing = [k for k, v in params.items() if v is None]
    if missing:
        await update.message.reply_text(
            "–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏: " + ", ".join(missing) + ". –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –∞–±–æ /cancel."
        )
        return ASK_INPUT

    result = interpret_hemodynamics(params)
    await update.message.reply_html(result)
    return ConversationHandler.END


async def algo_cancel(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("–°–∫–∞—Å–æ–≤–∞–Ω–æ. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å /algo, —â–æ–± –ø–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É.")
    return ConversationHandler.END


async def feedback(update: Update, context: ContextTypes.DEFAULT_TYPE):
    msg = update.message.text or ""
    user = update.effective_user
    logger.info("FEEDBACK from %s (%s): %s", user.username, user.id, msg)
    await update.message.reply_text("–î—è–∫—É—î–º–æ –∑–∞ –≤—ñ–¥–≥—É–∫! –ú–∏ –π–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–Ω–µ–º–æ.")


# -------------------- –ì–æ–ª–æ–≤–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É --------------------
def main():
    if not TOKEN:
        raise RuntimeError("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ TELEGRAM_TOKEN —É –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞")

    app = ApplicationBuilder().token(TOKEN).build()

    # –ë–∞–∑–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("help", help_cmd))
    app.add_handler(CommandHandler("about", about))

    # /feedback –ø—Ä–æ—Å—Ç–∏–π: –≤—Å–µ, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥—ñ—à–ª–µ –ø—ñ—Å–ª—è –∫–æ–º–∞–Ω–¥–∏ ‚Äî –ª–æ–≥–æ–º –≤ INFO
    app.add_handler(CommandHandler("feedback", feedback))

    # –†–æ–∑–º–æ–≤–∞ –¥–ª—è /algo
    conv = ConversationHandler(
        entry_points=[CommandHandler("algo", algo_entry)],
        states={
            ASK_INPUT: [MessageHandler(filters.TEXT & ~filters.COMMAND, algo_handle)],
        },
        fallbacks=[CommandHandler("cancel", algo_cancel)],
        allow_reentry=True,
    )
    app.add_handler(conv)

    # –ó–∞–ø—É—Å–∫ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è
    app.run_polling(close_loop=False)


if __name__ == "__main__":
    main()


# -------------------- requirements.txt --------------------
"""
python-telegram-bot==20.3
"""


# -------------------- README (—Å–∫–æ—Ä–æ—á–µ–Ω–æ) --------------------
"""
–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç:
1) –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Python 3.10+.
2) –ó–±–µ—Ä–µ–∂—ñ—Ç—å —Ü–µ–π —Ñ–∞–π–ª —è–∫ bot.py. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤ —Ü—ñ–π —Å–∞–º—ñ–π –ø–∞–ø—Ü—ñ —Ñ–∞–π–ª requirements.txt –∑ —Ä—è–¥–∫–æ–º:
   python-telegram-bot==20.3
3) –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:  pip install -r requirements.txt
4) –î–æ–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω:  export TELEGRAM_TOKEN=123456:ABC...  (Linux/Mac) –∞–±–æ set TELEGRAM_TOKEN=... (Windows)
5) –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:  python bot.py
6) –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ Telegram: –∑–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à–æ–≥–æ –±–æ—Ç–∞, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Start, –≤–∏–∫–æ–Ω–∞–π—Ç–µ /algo.

–†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Railway (–¥—É–∂–µ –∫–æ—Ä–æ—Ç–∫–æ):
- –°—Ç–≤–æ—Ä—ñ—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –Ω–∞ GitHub –∑ —Ñ–∞–π–ª–∞–º–∏ bot.py —ñ requirements.txt
- –ù–∞ railway.app —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ—î–∫—Ç ‚Üí Deploy from GitHub ‚Üí –æ–±–µ—Ä—ñ—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
- –£ Settings ‚Üí Variables –¥–æ–¥–∞–π—Ç–µ TELEGRAM_TOKEN
- –ó–∞–ø—É—Å–∫: Railway —Å–∞–º —Å—Ç–≤–æ—Ä–∏—Ç—å —Å–µ—Ä–≤—ñ—Å; –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ –≤–∫–∞–∂—ñ—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—É –∫–æ–º–∞–Ω–¥—É:  python bot.py

–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è/–∞–¥–∞–ø—Ç–∞—Ü—ñ—è:
- –ü–æ—Ä–æ–≥–∏ (GEDI/PPV/EVLWI/CI) –∑–º—ñ–Ω—ñ—Ç—å —É —Ñ—É–Ω–∫—Ü—ñ—ó interpret_hemodynamics()
- –î–æ–¥–∞–π—Ç–µ –Ω–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (CVP, SvO2, PaO2/FiO2) —É PARAM_KEYS, parse_params() —ñ –ª–æ–≥—ñ–∫—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó
- –î–æ–¥–∞–π—Ç–µ –¥–∂–µ—Ä–µ–ª–∞/–ø–æ—Å–∏–ª–∞–Ω–Ω—è —É ABOUT/HELP
- –£—Å—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º—ñ—Å—Ç—è—Ç—å –æ—Å–≤—ñ—Ç–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä —ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ—ó –∫–ª—ñ–Ω—ñ—á–Ω–æ—ó –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
"""
